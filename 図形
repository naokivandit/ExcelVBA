
'赤枠
Sub 赤枠()
    With ActiveSheet.Shapes.AddShape(msoShapeRectangle, 0, 0, 140, 40)
        With .TextFrame
            .HorizontalAlignment = xlHAlignCenter
            .VerticalAlignment = xlVAlignCenter
        End With

        With .Line
            .ForeColor.RGB = RGB(255, 0, 0)
            .Weight = 3
        End With
        .Select
        .Top = ActiveCell.Top
        .Left = ActiveCell.Left
        .Fill.Visible = msoFalse
    End With
End Sub


'緑吹き出し
Sub 緑吹き出し()
    With ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangularCallout, 0, 0, 240, 60)
        With .TextFrame
            With .Characters
                With .Font
                .Size = 18
                .Bold = True
                End With
                .Text = "サンプル"
            End With
            .HorizontalAlignment = xlHAlignCenter
            .VerticalAlignment = xlVAlignCenter
        End With

        With .Line
            .ForeColor.RGB = RGB(255, 255, 255)
            .Weight = 3
        End With
        .Select
        .Top = ActiveCell.Top
        .Left = ActiveCell.Left
        .Fill.Visible = True
        .Fill.ForeColor.RGB = RGB(146, 208, 80)
        .Adjustments.Item(1) = -0.6
        .Adjustments.Item(2) = 1
    End With
End Sub

'青矢印
Sub 青矢印()
    With ActiveSheet.Shapes.AddShape(msoShapeDownArrow, 0, 0, 60, 140)
        With .Line
            .ForeColor.RGB = RGB(255, 255, 255)
            .Weight = 3
        End With
        .Select
        .Top = ActiveCell.Top
        .Left = ActiveCell.Left
        .Fill.Visible = True
        .Fill.ForeColor.RGB = RGB(80, 145, 207)
    End With
End Sub

Sub アクティブセルに拡張子抜きのブック名を入力する()
  Dim bk_name As String

  bk_name = ActiveWorkbook.Name

  If ActiveSheet.Type = xlWorksheet Then
    ActiveCell.Value = _
    "'" & Left(bk_name, InStrRev(bk_name, ".") - 1)
  End If

End Sub

'F1使用禁止
Sub F1禁止()
    Application.OnKey "{F1}", ""
End Sub

Sub 保存時に全てのシートをA1にして一番最初のページにして更新日を更新()

Sheets("一覧").Range("H2").Value = Now
Range("A1").Select
Sheets("一覧").Select
ActiveWindow.Zoom = 100
Range("A1").Select
ActiveWindow.View = xlNormalView
ActiveWorkbook.Save

End Sub



